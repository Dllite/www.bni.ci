(function(b,a){$window=b(a);b.fn.lazyload=function(c){var e=this;var d={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:a,data_attribute:"original",skip_invisible:true,appear:null,load:null};var f;function g(){var h=0;e.each(function(){var i=b(this);if(d.skip_invisible&&!i.is(":visible")){return}if(b.abovethetop(this,f,d)||b.leftofbegin(this,f,d)){}else{if(!b.belowthefold(this,f,d)&&!b.rightoffold(this,f,d)){i.trigger("appear")}else{if(++h>d.failure_limit){return false}}}})}if(c){if(undefined!==c.failurelimit){c.failure_limit=c.failurelimit;delete c.failurelimit}if(undefined!==c.effectspeed){c.effect_speed=c.effectspeed;delete c.effectspeed}b.extend(d,c)}f=(d.container===undefined||d.container===a)?$window:b(d.container);if(0===d.event.indexOf("scroll")){f.bind(d.event,function(h){return g()})}this.each(function(){var h=this;var i=b(h);h.loaded=false;i.one("appear",function(){if(!this.loaded){if(d.appear){var j=e.length;d.appear.call(h,j,d)}b("<img />").bind("load",function(){i.hide().attr("src",i.data(d.data_attribute))[d.effect](d.effect_speed);h.loaded=true;var k=b.grep(e,function(m){return !m.loaded});e=b(k);if(d.load){var l=e.length;d.load.call(h,l,d)}}).attr("src",i.data(d.data_attribute))}});if(0!==d.event.indexOf("scroll")){i.bind(d.event,function(j){if(!h.loaded){i.trigger("appear")}})}});$window.bind("resize",function(h){g()});g();return this};b.belowthefold=function(d,f,e){var c;if(e.container===undefined||e.container===a){c=$window.height()+$window.scrollTop()}else{c=f.offset().top+f.height()}return c<=b(d).offset().top-e.threshold};b.rightoffold=function(d,f,e){var c;if(e.container===undefined||e.container===a){c=$window.width()+$window.scrollLeft()}else{c=f.offset().left+f.width()}return c<=b(d).offset().left-e.threshold};b.abovethetop=function(d,f,e){var c;if(e.container===undefined||e.container===a){c=$window.scrollTop()}else{c=f.offset().top}return c>=b(d).offset().top+e.threshold+b(d).height()};b.leftofbegin=function(d,f,e){var c;if(e.container===undefined||e.container===a){c=$window.scrollLeft()}else{c=f.offset().left}return c>=b(d).offset().left+e.threshold+b(d).width()};b.inviewport=function(c,e,d){return !b.rightofscreen(c,d)&&!b.leftofscreen(c,d)&&!b.belowthefold(c,d)&&!b.abovethetop(c,d)};b.extend(b.expr[":"],{"below-the-fold":function(c){return b.belowthefold(c,{threshold:0,container:a})},"above-the-top":function(c){return !b.belowthefold(c,{threshold:0,container:a})},"right-of-screen":function(c){return b.rightoffold(c,{threshold:0,container:a})},"left-of-screen":function(c){return !b.rightoffold(c,{threshold:0,container:a})},"in-viewport":function(c){return !b.inviewport(c,{threshold:0,container:a})},"above-the-fold":function(c){return !b.belowthefold(c,{threshold:0,container:a})},"right-of-fold":function(c){return b.rightoffold(c,{threshold:0,container:a})},"left-of-fold":function(c){return !b.rightoffold(c,{threshold:0,container:a})}})})(jQuery,window);